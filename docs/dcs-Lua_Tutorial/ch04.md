# Chapter 04 ‚Äî Where Lua ‚Äúlives‚Äù in DCS (and where to paste it)

üá¨üáß **English** | üá™üá∏ [Espa√±ol](ch04.es.md) | üá∏üá™ [Svenska](ch04.sv.md) | üá´üáÆ [Suomi](ch04.fi.md)

Back to index: [README.md](README.md)

Chapter example: [examples/ex04_where_lua_runs.lua](examples/ex04_where_lua_runs.lua)

## What you‚Äôll learn

- The 3 typical places where mission Lua runs in DCS.
- What ‚ÄúMission Scripting Environment (MSE)‚Äù means.
- When to use `DO SCRIPT` vs `DO SCRIPT FILE`.
- A key warning: ‚Äúsanitization‚Äù (no fear, just awareness).

## How it is used in DCS

Think of it like this: **your script lives inside your mission**.

DCS missions run Lua inside a built-in environment called the **Mission Scripting Environment (MSE)**. Inside the MSE you can do things like:

- Show messages (`trigger.action.outText`)
- Read flags (`trigger.misc.getUserFlag`)
- Create F10 menus (`missionCommands...`)
- Listen to events (`world.addEventHandler`)

Where does your script usually run?

1) **Triggers** (most common)
   - `DO SCRIPT` (paste Lua)
   - `DO SCRIPT FILE` (run a `.lua`)
2) **AI Tasking**
   - actions like *Script* / *Script File* (run logic ‚Äúas a task‚Äù)
3) **Initialization script**
   - runs very early (before units spawn and before the first trigger), depending on mission/server

### Safety note (no risky steps)

Many setups keep the mission environment **sanitized** for security:

- Some Lua libraries (like `io`, `os`, `lfs`) may be disabled or restricted.
- That is normal and expected.

This tutorial does **not** provide instructions to change that. We‚Äôll write scripts that work within normal mission limits.

## Quick test (step-by-step)

Goal: run a file and see **on-screen output** + **a log line**.

1) In Mission Editor, open your practice mission.
2) Go to *Triggers*.
3) Create a trigger:
   - **Type**: `MISSION START`
   - **Action**: `DO SCRIPT FILE`
4) Select: [examples/ex04_where_lua_runs.lua](examples/ex04_where_lua_runs.lua)
5) Save the mission.
6) Run it.

What you should notice:

- On screen: ‚Äúex04: This script ran (MSE).‚Äù
- In logs: a line containing `[DCS-Lua-Tutorial] ex04 loaded ...`

Where to find the log:

- Usually: `Saved Games\\DCS\\Logs\\dcs.log`

## Common errors and fixes

- **No on-screen message**:
  - Verify the trigger is `MISSION START`.
  - Test first with `DO SCRIPT` + a single `outText` (Chapter 03).
- **No log line**:
  - Find `dcs.log` under `Saved Games`.
  - Search for `DCS-Lua-Tutorial`.
- **The file doesn‚Äôt run**:
  - Re-select the file in `DO SCRIPT FILE`.
  - Save the mission again.

> **If you get an error, do this:**
> - Keep only the `outText(...)` line (remove `env.info`).
> - Once that works, add logging back.

## Mini‚Äëlab (15‚Äì25 min): a ‚Äúpractice base mission‚Äù

Goal: create a mission template you will reuse in every chapter.

1) Create a new mission (any map).
2) Place one player aircraft on the runway.
3) Add a `MISSION START` trigger with `DO SCRIPT FILE` and load `examples/ex04_where_lua_runs.lua`.
4) Save it as something like `lua_practice_base.miz`.
5) Run and confirm screen + log.

## Checklist (what you must see in-game)

- At mission start, you see an on-screen message (~10s).
- In `dcs.log`, you see a line with `ex04 loaded`.

## Navigation

Previous: [Chapter 03](ch03.md)  
Next: [Chapter 05](ch05.md)

