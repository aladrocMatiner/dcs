# Luku 02 â€” TyÃ¶putki, asennukset ja yleiset DCS Luaâ€‘kirjastot (VS Code)

ğŸ‡¬ğŸ‡§ [English](ch02.md) | ğŸ‡ªğŸ‡¸ [EspaÃ±ol](ch02.es.md) | ğŸ‡¸ğŸ‡ª [Svenska](ch02.sv.md) | ğŸ‡«ğŸ‡® **Suomi**

Takaisin hakemistoon: [README.fi.md](README.fi.md)

## Tavoite

Rakentaa kÃ¤ytÃ¤nnÃ¶llinen tyÃ¶putki DCSâ€‘tehtÃ¤vien Luaâ€‘skriptaukseen kÃ¤yttÃ¤en **Visual Studio Codea**, ja saada yleiskuva yleisimmistÃ¤ DCSâ€‘Luaâ€‘kirjastoista/ekosysteemeistÃ¤.

TÃ¤ssÃ¤ luvussa on edelleen **vÃ¤hÃ¤n koodia**. PÃ¤Ã¤tulos: â€œtiedÃ¤n miten tyÃ¶skentelenâ€.

## TyÃ¶putki (kirjoita â†’ pakkaa â†’ aja â†’ havainnoi â†’ iterioi)

Ajattele skriptausta silmukkana:

1. **Kirjoita**: muokkaa VS Codessa (nopea palaute, haku, versionhallinta).
2. **Pakkaa**: lisÃ¤Ã¤ skriptit (ja kirjastot) ajettavaan tehtÃ¤vÃ¤Ã¤n.
3. **Aja**: kÃ¤ynnistÃ¤ tehtÃ¤vÃ¤ DCS:ssÃ¤.
4. **Havainnoi**: varmista ettÃ¤ muutos nÃ¤kyy (viestit, kÃ¤yttÃ¤ytyminen, logit).
5. **Iteroi**: sÃ¤Ã¤dÃ¤ yksi asia kerrallaan.

Yleinen aloittelijan virhe on yrittÃ¤Ã¤ tehdÃ¤ â€œkoko logiikkaâ€ ennen kuin silmukka toimii. Rakenna silmukka ensin.

## MitÃ¤ pitÃ¤Ã¤ â€œasentaaâ€ (ja mitÃ¤ ei)

### Lua:n ajaminen DCS:ssÃ¤

Useimmiten sinun ei tarvitse asentaa Luaa erikseen, jotta voit *ajaa* tehtÃ¤vÃ¤sriptit DCS:ssÃ¤.

DCS suorittaa tehtÃ¤vÃ¤sriptauksen omalla sisÃ¤Ã¤nrakennetulla Luaâ€‘ympÃ¤ristÃ¶llÃ¤Ã¤n Mission Editorin triggereiden kautta (esim. `DO SCRIPT` / `DO SCRIPT FILE`).

### Mukavampi tyÃ¶skentely (valinnaiset paikalliset tyÃ¶kalut)

Paikalliset tyÃ¶kalut ovat **kirjoittamista** varten, eivÃ¤t DCS:n sisÃ¤istÃ¤ ajoa varten:

- **VS Code + Lua language server**: diagnostiikka, tÃ¤ydennys, navigointi.
- **Formatteri** (valinnainen): yhtenÃ¤inen tyyli ja selkeÃ¤t diffit.
- **Luaâ€‘tulkki** (valinnainen): pienet offlineâ€‘kokeilut.

Jos asennat Luaâ€‘tulkin: kÃ¤ytÃ¤ sitÃ¤ â€œharjoitteluunâ€. DCS ajaa silti omassa ympÃ¤ristÃ¶ssÃ¤Ã¤n, joten varmista aina pelissÃ¤.

## VS Code â€‘asetukset (kÃ¤ytÃ¤nnÃ¶llisesti)

### 1) Asenna Luaâ€‘laajennus / language server

Valitse VS Codeen Luaâ€‘laajennus, joka tarjoaa:

- SyntaksivÃ¤rityksen
- Diagnostiikan
- Automaattisen tÃ¤ydennyksen (language server)

Etsi â€œLua Language Serverâ€ â€‘tukea.

### 2) Valitse yksinkertainen kansiorakenne

Esimerkki:

- `scripts/` â€” oma tehtÃ¤vÃ¤koodisi
- `libs/` â€” kolmannen osapuolen kirjastot (MIST/MOOSE jne.)
- `missions/` â€” ajettava `.miz` (tai muistiinpanot)
- `notes/` â€” suunnittelumuistiinpanot ja TODO:t

TehtÃ¤vÃ¤ on â€œruntimeâ€‘konttiâ€; kansio on â€œsource of truthâ€.

### 3) Muotoilu (tasainen ja tylsÃ¤)

PidÃ¤ sisennys ja tyyli johdonmukaisena. Tavoite:

- SelkeÃ¤t diffit
- VÃ¤hemmÃ¤n â€œnÃ¤kymÃ¤ttÃ¶miÃ¤â€ virheitÃ¤
- Helpompi yhteistyÃ¶

Jos kÃ¤ytÃ¤t formatteria, vÃ¤ltÃ¤ suuria muotoilumuutoksia samaan aikaan logiikkamuutosten kanssa.

## DCSâ€‘API vs yhteisÃ¶n kirjastot

Kaksi maailmaa:

### DCS:n sisÃ¤Ã¤nrakennettu skriptaus

Peruspalikat:

- Tapahtumat
- Ajastimet / sÃ¤Ã¤nnÃ¶lliset tarkistukset
- Viestit
- PÃ¤Ã¤sy tehtÃ¤vÃ¤n objekteihin (yksikÃ¶t, ryhmÃ¤t, koalitiot, vyÃ¶hykkeet) DCS:n sallimissa rajoissa

### YhteisÃ¶n kirjastot / frameworkit

Kolmannen osapuolen Luaâ€‘paketteja, jotka auttavat vÃ¤lttÃ¤mÃ¤Ã¤n toiston:

- Korkeamman tason abstraktiot (tasking, spawning, AIâ€‘mallit)
- Aputoiminnot (haku, tila, ajoitus)
- UudelleenkÃ¤ytettÃ¤vÃ¤t jÃ¤rjestelmÃ¤t (logistiikka, IADS, pisteytys)

## YleisiÃ¤ DCSâ€‘Lua kirjastoja/frameworkeja (kÃ¤sitteellisesti)

### MIST (Mission Scripting Tools)

Usein utiliittikerros:

- Aputoimintoja ja yleisiÃ¤ malleja
- HyvÃ¤ jos haluat pysyÃ¤ lÃ¤hellÃ¤ â€œperus DCSâ€‘Luaaâ€ mutta vÃ¤hentÃ¤Ã¤ boilerplatea

### MOOSE (Mission Object Oriented Scripting Environment)

EnemmÃ¤n framework:

- Auttaa jÃ¤sentÃ¤mÃ¤Ã¤n isoja tehtÃ¤viÃ¤, joissa on paljon liikkuvia osia
- Korkeamman tason kÃ¤sitteitÃ¤ ja uudelleenkÃ¤ytettÃ¤vÃ¤Ã¤ logiikkaa

### Muut addâ€‘onit (kategoriat)

Saatat nÃ¤hdÃ¤ myÃ¶s:

- **IADSâ€‘jÃ¤rjestelmiÃ¤**
- **Logistiikka / joukkojen kuljetus**
- **Adminâ€‘tyÃ¶kaluja** moninpeliin

Ota nÃ¤mÃ¤ kÃ¤yttÃ¶Ã¶n vasta kun tyÃ¶putkesi on vakaa.

## Milloin kÃ¤ytÃ¤t triggereitÃ¤ vs Luaa vs kirjastoja?

Heuristiikka:

- Yksinkertainen ja staattinen: **Mission Editorin triggerit** riittÃ¤vÃ¤t usein.
- Dynaaminen kulku, tila, haarautuminen: **Lua** auttaa.
- Monimutkainen skenaario: **kirjastot/frameworkit** sÃ¤Ã¤stÃ¤vÃ¤t aikaa, mutta lisÃ¤Ã¤vÃ¤t yllÃ¤pitoa ja riippuvuuksia.

## Checklist: â€œtyÃ¶putkeni on valmisâ€

- [ ] VS Code on asennettu ja Lua language server on kÃ¤ytÃ¶ssÃ¤.
- [ ] Minulla on kansiorakenne (`scripts/`, `libs/` jne.) ja lÃ¶ydÃ¤n tiedostot nopeasti.
- [ ] TiedÃ¤n miten lisÃ¤Ã¤n skriptit tehtÃ¤vÃ¤Ã¤n (`DO SCRIPT` / `DO SCRIPT FILE`).
- [ ] Minulla on tapa varmistaa muutokset (viestit/logit/havaittava kÃ¤ytÃ¶s).
- [ ] TiedÃ¤n mihin suuntaan jatkan (perus Lua, MIST, vai MOOSE).

## Seuraavaksi

Seuraavassa luvussa kirjoitamme pienimmÃ¤t hyÃ¶dylliset skriptit ja rakennamme luotettavan â€œmuutos â†’ ajo â†’ varmistusâ€â€‘silmukan minimaalisella koodilla.

## Navigointi

Edellinen: [Luku 01](ch01.fi.md)
